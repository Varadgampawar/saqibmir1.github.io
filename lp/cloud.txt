'''
    Name : Sahil Chandan
    Div : A 
    Roll No : 10
    Assignment No. 9
'''
import RPi.GPIO as GPIO
import time
import datetime
import dht11
import http.client , urllib.request,urllib.parse
key = 'QPRBJ0K7C8EIPNII' # copy the write API key



GPIO.setmode(GPIO.BOARD)
GPIO.setwarnings(False)


instance = dht11.DHT11(pin=5)

while True:
    result=instance.read()
    if result.is_valid():
        
        print('Last valid input : '+str(datetime.datetime.now()))
        print('Temperatue : %d C'%result.temperature)
        t=result.temperature
        params=urllib.parse.urlencode({'field1':t,'key':key})
        headers={"Content-type":"application/x-www-form-urlencoded","Accept":"text/plain"}
        con=http.client.HTTPConnection("api.thingspeak.com")
        con.request("POST","/update",params,headers)
        response=con.getresponse()
        print (response.status,response.reason)
        data=response.read()
        con.close()
        
        
            
            
    time.sleep(0.5)
    
    



